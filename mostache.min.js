/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
!function(e,t){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):(e.Mustache={},t(Mustache)),t.global=e}(this,function e(t){"use strict"
function r(e){return"function"==typeof e}function n(e){return g(e)?"array":typeof e}function i(e){return e.replace(O,"\\$&")}function s(e,t){return e!=f&&"object"==typeof e&&t in e}function a(e){return String(e).replace(_,function(e){return $[e]})}function o(e,r){function n(){if(v&&!w)for(;d.length;)delete f[d.pop()]
else d=[]
v=!1,w=!1}function s(e){if("string"==typeof e&&(e=e.split(N,2)),!g(e)||2!==e.length)throw new Error("Invalid tags: "+e)
a=new RegExp(i(e[0])+"\\s*"),o=new RegExp("\\s*"+i(e[1])),l=new RegExp("\\s*"+i("}"+e[1]))}if(!e)return[]
var a,o,l,h=[],f=[],d=[],v=!1,w=!1
s(r||t.tags)
for(var y,b,m,k,x,E,_=new u(e);_.tail;){if(y=_.pos,m=_.scanUntil(a))for(var O=0,S=m.length;S>O;++O)k=m.charAt(O),U.test(k)?d.push(f.length):w=!0,f.push(["text",k,y,y+1]),y+=1,"\n"===k&&n()
if(!_.scan(a))break
if(v=!0,b=_.scan(j)||"name",_.scan(T),"="===b?(m=_.scanUntil(R),_.scan(R),_.scanUntil(o)):"{"===b?(m=_.scanUntil(l),_.scan(V),_.scanUntil(o),b="&"):m=_.scanUntil(o),!_.scan(o))throw new Error("Unclosed tag at "+_.pos)
if(x=[b,m,y,_.pos],f.push(x),"#"===b||"^"===b)h.push(x)
else if("/"===b){if(E=h.pop(),!E)throw new Error('Unopened section "'+m+'" at '+y)
if(E[1]!==m)throw new Error('Unclosed section "'+E[1]+'" at '+y)}else"name"===b||"{"===b||"&"===b?w=!0:"="===b&&s(m)}if(E=h.pop())throw new Error('Unclosed section "'+E[1]+'" at '+_.pos)
return p(c(f))}function c(e){for(var t,r,n=[],i=0,s=e.length;s>i;++i)t=e[i],t&&(r&&"text"===t[0]&&"text"===r[0]?(r[1]+=t[1],r[3]=t[3]):(n.push(t),r=t))
return n}function p(e){for(var t,r,n=[],i=n,s=[],a=0,o=e.length;o>a;++a)switch(t=e[a],t[0]){case"#":case"^":i.push(t),s.push(t),i=t[4]=[]
break
case"/":r=s.pop(),r[5]=t[2],i=s.length>0?s[s.length-1][4]:n
break
default:i.push(t)}return n}function u(e){this.string=e,this.tail=e,this.pos=0}function l(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function h(){this.cache={}}var f,d=Object.prototype.toString,g=Array.isArray||function(e){return"[object Array]"===d.call(e)},v=/\{\{!([\w\.]+?)\}\}/g,w=/(\W)@([#\^!\/\|\.\)\(]?[\w\.$|]+)/g,y=/\s*\=\s*/,b=/\s*\:\s*/,m=/\s*\,\s*/,k=/\s*\|\s*/,x=/\s*\|{2}\s*/,E=/\{INDEX\}/g,_=/[&<>"'\/]/g,O=/[\-\[\]{}()*+?.,\\\^$|#\s]/g,S=/\{SEP\}([\w\W]+?)\{\/SEP\}/g,U=/\S/,$={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},T=/\s*/,N=/\s+/,R=/\s*=/,V=/\s*\}/,j=/#|\^|\/|>|\{|&|=|!/
u.prototype.eos=function(){return""===this.tail},u.prototype.scan=function(e){var t,r,n=this.tail
return t=n.match(e),t&&0===t.index?(r=t[0],this.tail=n.substring(r.length),this.pos+=r.length,r):""},u.prototype.scanUntil=function(e){var t,r=this.tail.search(e)
switch(r){case-1:t=this.tail,this.tail=""
break
case 0:t=""
break
default:t=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=t.length,t},l.prototype.push=function(e){return new l(e,this)},l.prototype.lookup=function(t){var n,i,a,o,c,p=this.cache,u=[]
if(-1!==t.indexOf("!=")&&(o=t.trim().split(y),t=o[0].slice(0,-1),p[t]==o[1]&&p["."][t]==o[1]&&(t=""),o=i),-1!==t.indexOf("=")&&(o=t.trim().split(y),t=o[0],p[t]!=o[1]&&p["."][t]!=o[1]&&(t=""),o=i),-1!==t.indexOf(":")&&(o=t.trim().split(b),t=o[0],p.__NAME=o[1],o=i),-1!==t.search(/[^|]\|{2}[^|]/)&&(o=t.trim().split(x),t=o.shift(),p.__OR=o,o=i),-1!==t.search(/[^|]\|[^|]/)&&(o=t.trim().split(k).map(function(e,t){return"."===e.slice(0,1)&&(u[t-1]=!0,e=e.slice(1)),e}),t=o.shift()),(n=p[t])==i){for(var l,h,f=this,d=!1;f;){if(t.indexOf(".")>0)for(n=f.view,l=t.split("."),h=0,"__"!==l[0]||f.parent||l.shift(),a=l.length;n!=i&&a>h;)h===a-1&&(d=s(n,l[h])),n=n[l[h++]]
else n=f.view[t],d=s(f.view,t)
if(d)break
f=f.parent}p[t]=n}return o!==i&&o.forEach(function(r,i){function s(e,t){return t.split(/[\.,]/).reduce(function(e,t){return e&&e[t]},e)}var a=r.split("(")
r=a.shift(),a.length&&(a=a[0].trim().split(")")[0].trim().split(m).map(function(e){try{return JSON.parse(e)}catch(t){return e}}))
var o,c=s(u[i]?n===o?t:n:e.global,r)
if("function"==typeof c){n===o&&(n=t)
try{if(u[i])n=a.length?c.apply(n,a):c.call(n)
else if(a.length)switch(a.length){case 1:return n=c(n,a[0])
case 2:return n=c(n,a[0],a[1])
case 3:return n=c(n,a[0],a[1],a[2])
default:return c.apply(this,[n].concat(a))}else n=c(n)}catch(p){}}}),r(n)&&(n=-1!==String(n).indexOf("[native code]")&&c?n.call(c):n.call(this.view)),n},h.prototype.clearCache=function(){this.cache={}},h.prototype.parse=function(e,t){var r,n=this.cache,i=n[e]
return i==r&&(i=n[e]=o(e,t)),i},h.prototype.render=function(e,t,r){var n=this.parse(e),i=t instanceof l?t:new l(t)
return this.renderTokens(n,i,r,e)},h.prototype.renderTokens=function(e,t,r,n){for(var i,s,a,o,c="",p=0,u=e.length;u>p;++p){switch(a=o,i=e[p],s=i[0]){case"#":a=this.renderSection(i,t,r,n)
break
case"^":a=this.renderInverted(i,t,r,n)
break
case">":a=this.renderPartial(i,t,r,n)
break
case"&":a=this.unescapedValue(i,t)
break
case"name":a=this.escapedValue(i,t)
break
case"text":a=this.rawValue(i)}a!==o&&(c+=a)}return c},h.prototype.renderSection=function(e,t,n,i){function s(e){return o.render(e,t,n)}var a,o=this,c="",p=t.lookup(e[1]),u="$1"
if(p){if(g(p))for(var l=0,h=p.length;h>l;++l)u=h-1===l?"":"$1",c+=this.renderTokens(e[4],t.push(p[l]),n,i).replace(E,l+1).replace(S,u)
else if("object"==typeof p||"string"==typeof p||"number"==typeof p)if(p!=a&&"object"==typeof p&&t.cache.__NAME)for(var f in p){var d=p[f],v=d
if("object"==typeof d){d={},d[t.cache.__NAME]=f
for(var w in v)v.hasOwnProperty(w)&&(d[w]=v[w])}else d=new d.constructor(d),d[t.cache.__NAME]=f
u=h-1===l?"":"$1",c+=this.renderTokens(e[4],t.push(d),n,i).replace(E,f).replace(S,u)}else c+=this.renderTokens(e[4],t.push(p),n,i).replace(S,u)
else if(r(p)){if("string"!=typeof i)throw new Error("Cannot use higher-order sections without the original template")
p=p.call(t.view,i.slice(e[3],e[5]),s),p!=a&&(c+=p)}else c+=this.renderTokens(e[4],t,n,i)
return c}},h.prototype.renderInverted=function(e,t,r,n){var i=t.lookup(e[1])
return!i||g(i)&&0===i.length?this.renderTokens(e[4],t,r,n):void 0},h.prototype.renderPartial=function(e,t,n){if(n){var i,s=String(e[1]).trim().split(/\s+/),a=n[e[1]]
return r(n)&&(a=n(s[0],s.slice(1),t.view)),r(n[s[0]])&&(a=n[s[0]](s.slice(1),t.view)),a!=i?this.renderTokens(this.parse(a),t,n,a):void 0}},h.prototype.unescapedValue=function(e,t){var r,n=t.lookup(e[1])
return n!=r?n:void 0},h.prototype.escapedValue=function(e,r){var n,i=r.lookup(e[1])
return i===n&&r.cache.__OR&&(i=r.cache.__OR.reduce(function(e,t,n){return(1===n?this.interpretRawValue(e,r):e)||this.interpretRawValue(t,r)}.bind(this))),i!==n?t.escape(i):void 0},h.prototype.rawValue=function(e){return e[1]},h.prototype.interpretRawValue=function(e,t){return 0===e.search(/^['"].*['"]$/)?e.substr(1,e.length-2):isNaN(e)?t.lookup(e):parseFloat(e)},t.name="mustache.js",t.version="2.1.3",t.tags=["{{","}}"]
var A=new h
t.clearCache=function(){return A.clearCache()},t.parse=function(e,t){return A.parse(e,t)},t.render=function M(e,t,r){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+n(e)+'" was given as the first argument for mustache#render(template, view, partials)');-1!==e.indexOf("{{@@}}")&&(e=e.replace(w,"$1{{$2}}"))
var i="{{=<@ @>=}}"
return-1!==e.indexOf("<@")&&-1!==e.indexOf("@>")&&e.slice(0,11)!=i&&(e=M(i+" "+e,t,r||{})),A.render(e.replace(v,"{{/$1}}{{^$1}}"),t,r)},t.to_html=function(e,n,i,s){var a=t.render(e,n,i)
return r(s)?void s(a):a},t.escape=a,t.Scanner=u,t.Context=l,t.Writer=h})
