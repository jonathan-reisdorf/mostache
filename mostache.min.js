/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
!function(e,t){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):(e.Mustache={},t(Mustache)),t.global=e}(this,function e(t){"use strict"
function r(e){return"function"==typeof e}function n(e){return g(e)?"array":typeof e}function i(e){return e.replace(O,"\\$&")}function s(e,t){return e!=f&&"object"==typeof e&&t in e}function o(e){return String(e).replace(_,function(e){return T[e]})}function a(e,r){function n(){if(v&&!w)for(;d.length;)delete f[d.pop()]
else d=[]
v=!1,w=!1}function s(e){if("string"==typeof e&&(e=e.split(j,2)),!g(e)||2!==e.length)throw new Error("Invalid tags: "+e)
o=new RegExp(i(e[0])+"\\s*"),a=new RegExp("\\s*"+i(e[1])),h=new RegExp("\\s*"+i("}"+e[1]))}if(!e)return[]
var o,a,h,l=[],f=[],d=[],v=!1,w=!1
s(r||t.tags)
for(var y,b,m,k,x,E,_=new u(e);_.tail;){if(y=_.pos,m=_.scanUntil(o))for(var O=0,U=m.length;U>O;++O)k=m.charAt(O),S.test(k)?d.push(f.length):w=!0,f.push(["text",k,y,y+1]),y+=1,"\n"===k&&n()
if(!_.scan(o))break
if(v=!0,b=_.scan(M)||"name",_.scan($),"="===b?(m=_.scanUntil(A),_.scan(A),_.scanUntil(a)):"{"===b?(m=_.scanUntil(h),_.scan(N),_.scanUntil(a),b="&"):m=_.scanUntil(a),!_.scan(a))throw new Error("Unclosed tag at "+_.pos)
if(x=[b,m,y,_.pos],f.push(x),"#"===b||"^"===b)l.push(x)
else if("/"===b){if(E=l.pop(),!E)throw new Error('Unopened section "'+m+'" at '+y)
if(E[1]!==m)throw new Error('Unclosed section "'+E[1]+'" at '+y)}else"name"===b||"{"===b||"&"===b?w=!0:"="===b&&s(m)}if(E=l.pop())throw new Error('Unclosed section "'+E[1]+'" at '+_.pos)
return p(c(f))}function c(e){for(var t,r,n=[],i=0,s=e.length;s>i;++i)t=e[i],t&&(r&&"text"===t[0]&&"text"===r[0]?(r[1]+=t[1],r[3]=t[3]):(n.push(t),r=t))
return n}function p(e){for(var t,r,n=[],i=n,s=[],o=0,a=e.length;a>o;++o)switch(t=e[o],t[0]){case"#":case"^":i.push(t),s.push(t),i=t[4]=[]
break
case"/":r=s.pop(),r[5]=t[2],i=s.length>0?s[s.length-1][4]:n
break
default:i.push(t)}return n}function u(e){this.string=e,this.tail=e,this.pos=0}function h(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function l(){this.cache={}}var f,d=Object.prototype.toString,g=Array.isArray||function(e){return"[object Array]"===d.call(e)},v=/\{\{!([\w\.]+?)\}\}/g,w=/(\W)@([#\^!\/\|\.\)\(]?[\w\.$|]+)/g,y=/\s*\=\s*/,b=/\s*\:\s*/,m=/\s*\,\s*/,k=/\s*\|\s*/,x=/\s*\|{2}\s*/,E=/\{INDEX\}/g,_=/[&<>"'\/]/g,O=/[\-\[\]{}()*+?.,\\\^$|#\s]/g,U=/\{SEP\}([\w\W]+?)\{\/SEP\}/g,S=/\S/,T={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},$=/\s*/,j=/\s+/,A=/\s*=/,N=/\s*\}/,M=/#|\^|\/|>|\{|&|=|!/
u.prototype.eos=function(){return""===this.tail},u.prototype.scan=function(e){var t,r,n=this.tail
return t=n.match(e),t&&0===t.index?(r=t[0],this.tail=n.substring(r.length),this.pos+=r.length,r):""},u.prototype.scanUntil=function(e){var t,r=this.tail.search(e)
switch(r){case-1:t=this.tail,this.tail=""
break
case 0:t=""
break
default:t=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=t.length,t},h.prototype.push=function(e){return new h(e,this)},h.prototype.lookup=function(t){var n,i,o,a,c,p=this.cache,u=[]
if(-1!==t.indexOf("=")&&(a=t.trim().split(y),t=a[0],p[t]!=a[1]&&p["."][t]!=a[1]&&(t=""),a=i),-1!==t.indexOf(":")&&(a=t.trim().split(b),t=a[0],p.__NAME=a[1],a=i),-1!==t.search(/[^|]\|{2}[^|]/)&&(a=t.trim().split(x),t=a[0],p.__OR=a[1],a=i),-1!==t.search(/[^|]\|[^|]/)&&(a=t.trim().split(k).map(function(e,t){return"."===e.slice(0,1)&&(u[t-1]=!0,e=e.slice(1)),e}),t=a.shift()),(n=p[t])==i){for(var h,l,f=this,d=!1;f;){if(t.indexOf(".")>0)for(n=f.view,h=t.split("."),l=0,"__"!==h[0]||f.parent||h.shift(),o=h.length;n!=i&&o>l;)l===o-1&&(d=s(n,h[l])),n=n[h[l++]]
else n=f.view[t],d=s(f.view,t)
if(d)break
f=f.parent}p[t]=n}return a!==i&&a.forEach(function(r,i){function s(e,t){return t.split(/[\.,]/).reduce(function(e,t){return e&&e[t]},e)}var o=r.split("(")
r=o.shift(),o.length&&(o=o[0].trim().split(")")[0].trim().split(m).map(function(e){try{return JSON.parse(e)}catch(t){return e}}))
var a,c=s(u[i]?n===a?t:n:e.global,r)
if("function"==typeof c){n===a&&(n=t)
try{if(u[i])n=o.length?c.apply(n,o):c.call(n)
else if(o.length)switch(o.length){case 1:return n=c(n,o[0])
case 2:return n=c(n,o[0],o[1])
case 3:return n=c(n,o[0],o[1],o[2])
default:return c.apply(this,[n].concat(o))}else n=c(n)}catch(p){}}}),r(n)&&(n=-1!==String(n).indexOf("[native code]")&&c?n.call(c):n.call(this.view)),n},l.prototype.clearCache=function(){this.cache={}},l.prototype.parse=function(e,t){var r,n=this.cache,i=n[e]
return i==r&&(i=n[e]=a(e,t)),i},l.prototype.render=function(e,t,r){var n=this.parse(e),i=t instanceof h?t:new h(t)
return this.renderTokens(n,i,r,e)},l.prototype.renderTokens=function(e,t,r,n){for(var i,s,o,a,c="",p=0,u=e.length;u>p;++p){switch(o=a,i=e[p],s=i[0]){case"#":o=this.renderSection(i,t,r,n)
break
case"^":o=this.renderInverted(i,t,r,n)
break
case">":o=this.renderPartial(i,t,r,n)
break
case"&":o=this.unescapedValue(i,t)
break
case"name":o=this.escapedValue(i,t)
break
case"text":o=this.rawValue(i)}o!==a&&(c+=o)}return c},l.prototype.renderSection=function(e,t,n,i){function s(e){return a.render(e,t,n)}var o,a=this,c="",p=t.lookup(e[1]),u="$1"
if(p){if(g(p))for(var h=0,l=p.length;l>h;++h)u=l-1===h?"":"$1",c+=this.renderTokens(e[4],t.push(p[h]),n,i).replace(E,h+1).replace(U,u)
else if("object"==typeof p||"string"==typeof p||"number"==typeof p)if(p!=o&&"object"==typeof p&&t.cache.__NAME)for(var f in p){var d=p[f],v=d
if("object"==typeof d){d={},d[t.cache.__NAME]=f
for(var w in v)v.hasOwnProperty(w)&&(d[w]=v[w])}else d=new d.constructor(d),d[t.cache.__NAME]=f
u=l-1===h?"":"$1",c+=this.renderTokens(e[4],t.push(d),n,i).replace(E,f).replace(U,u)}else c+=this.renderTokens(e[4],t.push(p),n,i).replace(U,u)
else if(r(p)){if("string"!=typeof i)throw new Error("Cannot use higher-order sections without the original template")
p=p.call(t.view,i.slice(e[3],e[5]),s),p!=o&&(c+=p)}else c+=this.renderTokens(e[4],t,n,i)
return c}},l.prototype.renderInverted=function(e,t,r,n){var i=t.lookup(e[1])
return!i||g(i)&&0===i.length?this.renderTokens(e[4],t,r,n):void 0},l.prototype.renderPartial=function(e,t,n){if(n){var i,s=r(n)?n(e[1]):n[e[1]]
return s!=i?this.renderTokens(this.parse(s),t,n,s):void 0}},l.prototype.unescapedValue=function(e,t){var r,n=t.lookup(e[1])
return n!=r?n:void 0},l.prototype.escapedValue=function(e,r){var n,i=r.lookup(e[1])
return i===n&&r.cache.__OR!==n&&(i=r.cache.__OR),i!=n?t.escape(i):void 0},l.prototype.rawValue=function(e){return e[1]},t.name="mustache.js",t.version="2.1.3",t.tags=["{{","}}"]
var R=new l
t.clearCache=function(){return R.clearCache()},t.parse=function(e,t){return R.parse(e,t)},t.render=function(e,t,r){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+n(e)+'" was given as the first argument for mustache#render(template, view, partials)')
return-1!==e.indexOf("{{@@}}")&&(e=e.replace(w,"$1{{$2}}")),R.render(e.replace(v,"{{/$1}}{{^$1}}"),t,r)},t.to_html=function(e,n,i,s){var o=t.render(e,n,i)
return r(s)?void s(o):o},t.escape=o,t.Scanner=u,t.Context=h,t.Writer=l})
